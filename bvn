local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Remotes = ReplicatedStorage:WaitForChild("Remotes")
local SystemMessage = Remotes:WaitForChild("Misc"):WaitForChild("SystemMessage")

local WEBHOOK_URL = "https://discord.com/api/webhooks/1409154986595713124/Ye8el184b9j8_YVgi67F650H1PCo3qhs_PgVSpdBx6nuvCIlL_0Jm_zNXi5B8mMNkuMI"

-- Fungsi kirim ke Discord via Synapse/Exploit
local Request = syn and syn.request or http_request or request or nil
local function sendToDiscord(content)
    if not Request then return end
    Request({
        Url = WEBHOOK_URL,
        Method = "POST",
        Headers = { ["Content-Type"] = "application/json" },
        Body = HttpService:JSONEncode({ content = content })
    })
end

-- Listen RemoteEvent
SystemMessage.OnClientEvent:Connect(function(...)
    local args = {...} -- args[1] = [System]: text, args[2] = Color3, args[3] = table Extra

    local text = args[1]
    local extra = args[3]

    if typeof(text) == "string" and typeof(extra) == "table" then
        local rarity = extra.Rarity or extra["Rarity"]
        if rarity == "Mythic" or rarity == "Exotic" then
            -- Ambil teks setelah "[System]: "
            local content = text:match("%[System%]:%s*(.+)")
            -- Hanya kirim kalau teks tidak diawali "Tip"
            if content and not content:match("^Tip") then
                sendToDiscord(content)
            end
        end
    end
end)
