--// Config
local WEBHOOK_URL = "https://discord.com/api/webhooks/1406862075988545658/a7sM5kebE9xUS_CNlWrPlwMOI-PLY3pZmKltgjfrsy4239Ee-RKLXYuX33DUWMGkby74"

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

--// Fungsi kirim ke Discord
local function sendToDiscord(sourceName, obj, args)
    local data = {
        username = "Remote Logger",
        content = string.format(
            "**[%s] %s**\n```lua\n%s\n```",
            sourceName,
            obj:GetFullName(),
            HttpService:JSONEncode(args)
        )
    }

    local body = HttpService:JSONEncode(data)
    local request = (http_request or request or syn.request)
    if request then
        request({
            Url = WEBHOOK_URL,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = body
        })
    end
end

--// Blacklist supaya ga spam
local blacklist = {
    "TimeSyncEvent", -- contohnya
}

local function isBlacklisted(name)
    for _, b in ipairs(blacklist) do
        if string.find(name, b) then
            return true
        end
    end
    return false
end

--// Hook Remotes
local function hookRemotes(parent, sourceName)
    for _, obj in ipairs(parent:GetDescendants()) do
        if obj:IsA("RemoteEvent") and not isBlacklisted(obj.Name) then
            obj.OnClientEvent:Connect(function(...)
                local args = {...}
                warn("[RemoteEvent]["..sourceName.."]:", obj:GetFullName(), ...)
                sendToDiscord(sourceName, obj, args)
            end)
        elseif obj:IsA("RemoteFunction") and not isBlacklisted(obj.Name) then
            local old = obj.OnClientInvoke
            obj.OnClientInvoke = function(...)
                local args = {...}
                warn("[RemoteFunction]["..sourceName.."]:", obj:GetFullName(), ...)
                sendToDiscord(sourceName, obj, args)
                if old then
                    return old(...)
                end
            end
        end
    end
end

-- Hook static
hookRemotes(game.ReplicatedStorage, "ReplicatedStorage")
hookRemotes(LocalPlayer:WaitForChild("PlayerGui"), "PlayerGui")
hookRemotes(workspace, "Workspace")

-- Hook dynamic (kalau remote baru muncul belakangan)
game.DescendantAdded:Connect(function(obj)
    if isBlacklisted(obj.Name) then return end
    if obj:IsA("RemoteEvent") then
        obj.OnClientEvent:Connect(function(...)
            local args = {...}
            warn("[RemoteEvent][Dynamic]:", obj:GetFullName(), ...)
            sendToDiscord("Dynamic", obj, args)
        end)
    elseif obj:IsA("RemoteFunction") then
        obj.OnClientInvoke = function(...)
            local args = {...}
            warn("[RemoteFunction][Dynamic]:", obj:GetFullName(), ...)
            sendToDiscord("Dynamic", obj, args)
        end
    end
end)
